webpackJsonp([7],{DWv2:function(e,t,a){var o=a("PvEC");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);a("8bSs")("1c4d7ba4",o,!0)},PvEC:function(e,t,a){(e.exports=a("BkJT")(!1)).push([e.i,"\n.spec-button{\r\n  height: 60px;\r\n  padding: 10px;\n}\n.name{\r\n  width: 200px;\r\n  margin-left: 50px;\n}\n.avatar-uploader .el-upload {\r\n  border: 1px dashed #d9d9d9;\r\n  border-radius: 6px;\r\n  cursor: pointer;\r\n  position: relative;\r\n  overflow: hidden;\n}\n.avatar-uploader .el-upload:hover {\r\n  border-color: #409EFF;\n}\n.avatar-uploader-icon {\r\n  font-size: 28px;\r\n  color: #8c939d;\r\n  width: 146px;\r\n  height: 146px;\r\n  line-height: 146px;\r\n  text-align: center;\n}\n.avatar {\r\n  width: 146px;\r\n  height: 146px;\r\n  display: block;\n}\r\n",""])},vFK7:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("EFWR"),l=o.a.ajax,r=o.a.api,n=o.a.getOldPager,i=o.a.dateFormat,s={data:function(){return{tableData:[],addView:!1,updateView:!1,pager:{name:"",pageIndex:1,pageSize:10,orderBy:"sort_num asc"},form:{id:"",imageUrl:"",notes:"",content:"",keywords:"",relation:"",sortNum:""},keywords:[{value:"index",label:"首页"},{value:"2",label:"其它"}],relation:[{value:1,label:"商品"},{value:2,label:"页面"},{value:3,label:"图片"}],total:0,fileUrl:r.uploadImage,dialogVisible:!1,dialogImageUrl:"",goodsList:[],pageList:[{id:"/pages/partner/index",name:"会员升级"}],content:[]}},mounted:function(){var e=n();null!=e&&""!==e&&(this.pager=e),this.getPager()},methods:{toData:function(e,t){return i(e,t)},handleSizeChange:function(e){this.pager.pageSize=e,this.getPager()},handleCurrentChange:function(e){this.pager.pageIndex=e,this.getPager()},getPager:function(){var e=this;l(r.bannerPager,"POST",this.pager,function(t){e.tableData=t.list,e.total=t.total,e.pager.pageIndex=t.pageIndex,t.pageIndex>t.maxPages&&(e.pager.pageIndex=t.maxPages,e.getPager())})},handleDelete:function(e){var t=this;this.$confirm("确认删除该规格吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){l(r.bannerDelete,"POST",{id:e},function(e){t.$message({type:"success",message:"删除成功!"}),t.getPager()})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},toUpdateView:function(e){this.vacant(),this.getDetails(e),this.updateView=!0},toAddView:function(){this.vacant(),this.addView=!0},beforeAvatarUpload:function(e){console.log("上传前判断")},uploadError:function(e,t,a){console.log("上传失败，请重试！")},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},uploadImageSuccess:function(e,t,a){2e4===e.code&&(this.form.imageUrl=e.url)},uploadDetailImageSuccess:function(e,t,a){2e4===e.code&&(this.content=a)},uploadDetailImageRemove:function(e,t){this.content=t},uploadImageFormat:function(e){for(var t="",a=0;a<e.length;a++){console.log(e[a]);var o=e[a].response;t=0===a?o.url:t+","+o.url}return t},typeChange:function(){var e=this;if(console.log(this.form.relation),1===this.form.relation){l(r.goodsList,"POST",this.pager,function(t){e.goodsList=t.list})}},add:function(e){var t=this;3===this.form.relation&&(this.form.content=this.uploadImageFormat(this.content)),this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;l(r.bannerAdd,"POST",t.form,function(e){t.addView=!1,t.getPager(),t.$message({message:"添加成功",type:"success"})})})},update:function(e){var t=this;3===this.form.relation&&(this.form.content=this.uploadImageFormat(this.content)),this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;l(r.bannerUpdate,"POST",t.form,function(e){t.updateView=!1,t.getPager(),t.$message({message:"修改成功",type:"success"})})})},getDetails:function(e){var t=this;l(r.bannerSelect,"POST",{id:e},function(e){t.form.id=e.id,t.form.imageUrl=e.imageUrl,t.form.keywords=e.keywords,t.form.relation=e.relation,t.form.notes=e.notes,t.form.sortNum=e.sortNum,1===t.form.relation&&l(r.goodsList,"POST",t.pager,function(e){t.goodsList=e.list});if(3===t.form.relation){var a=e.content.split(",");for(var o in a){var n={};n.url=a[o];var i={};i.url=a[o],i.response=n,t.content.push(i)}}else t.form.content=e.content;console.log(t.content)})},vacant:function(){this.form.id="",this.form.imageUrl="",this.form.keywords="",this.form.relation="",this.form.notes="",this.form.content="",this.content=[],this.form.sortNum=""}}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"banner"},[a("el-row",{staticClass:"spec-button"},[a("el-button",{attrs:{type:"primary"},on:{click:e.toAddView}},[e._v("添加")]),e._v(" "),a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.getPager},model:{value:e.pager.keywords,callback:function(t){e.$set(e.pager,"keywords",t)},expression:"pager.keywords"}},e._l(e.keywords,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),a("el-button",{on:{click:e.getPager}},[e._v("查询")])],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"thumbnailImage",label:"展示图",width:"180",sortable:""},scopedSlots:e._u([{key:"default",fn:function(e){return[a("img",{attrs:{src:e.row.imageUrl,width:"150",height:"56"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"keywords",label:"位置",width:"80",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return["index"==t.row.keywords?a("el-tag",{attrs:{size:"small",type:"info"}},[e._v("首页")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"relation",label:"关联类型",width:"120",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.relation?a("el-tag",{attrs:{size:"small",type:""}},[e._v("商品")]):e._e(),e._v(" "),2==t.row.relation?a("el-tag",{attrs:{size:"small",type:""}},[e._v("页面")]):e._e(),e._v(" "),3==t.row.relation?a("el-tag",{attrs:{size:"small",type:""}},[e._v("图片")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"content",label:"关联内容",width:"200",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"notes",label:"说明",width:"150",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"sortNum",label:"排序",width:"100",sortable:""}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){e.toUpdateView(t.row.id)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){e.handleDelete(t.row.id)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("el-pagination",{attrs:{background:"","current-page":e.pager.pageIndex,"page-sizes":[5,10,20,40],"page-size":e.pager.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.$set(e.pager,"pageIndex",t)}}}),e._v(" "),a("el-dialog",{attrs:{title:"添加",visible:e.addView,width:"500px"},on:{"update:visible":function(t){e.addView=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px",size:"small"}},[a("el-form-item",{attrs:{label:"展示图"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.fileUrl,multiple:"",name:"files","show-file-list":!1,onError:e.uploadError,onSuccess:e.uploadImageSuccess,beforeUpload:e.beforeAvatarUpload,"on-preview":e.handlePictureCardPreview}},[e.form.imageUrl?a("img",{staticClass:"avatar",attrs:{src:e.form.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),a("el-form-item",{attrs:{label:"位置"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.keywords,callback:function(t){e.$set(e.form,"keywords",t)},expression:"form.keywords"}},e._l(e.keywords,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"关联类型"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.typeChange},model:{value:e.form.relation,callback:function(t){e.$set(e.form,"relation",t)},expression:"form.relation"}},e._l(e.relation,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"关联内容"}},[1==e.form.relation?a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}},e._l(e.goodsList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})):2==e.form.relation?a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}},e._l(e.pageList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})):3==e.form.relation?a("el-upload",{attrs:{action:e.fileUrl,multiple:"",name:"files","list-type":"picture-card",onError:e.uploadError,onSuccess:e.uploadDetailImageSuccess,beforeUpload:e.beforeAvatarUpload,"on-preview":e.handlePictureCardPreview,"on-remove":e.uploadDetailImageRemove}},[a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]):a("el-input",{model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"说明"}},[a("el-input",{model:{value:e.form.notes,callback:function(t){e.$set(e.form,"notes",t)},expression:"form.notes"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"排序编号"}},[a("el-input",{model:{value:e.form.sortNum,callback:function(t){e.$set(e.form,"sortNum",t)},expression:"form.sortNum"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.add("form")}}},[e._v("添加")]),e._v(" "),a("el-button",{on:{click:function(t){e.addView=!1}}},[e._v("取消")])],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})]),e._v(" "),a("el-dialog",{attrs:{title:"修改",visible:e.updateView,width:"500px"},on:{"update:visible":function(t){e.updateView=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px",size:"small"}},[a("el-form-item",{attrs:{label:"展示图"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.fileUrl,multiple:"",name:"files","show-file-list":!1,onError:e.uploadError,onSuccess:e.uploadImageSuccess,beforeUpload:e.beforeAvatarUpload,"on-preview":e.handlePictureCardPreview}},[e.form.imageUrl?a("img",{staticClass:"avatar",attrs:{src:e.form.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),a("el-form-item",{attrs:{label:"位置"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.keywords,callback:function(t){e.$set(e.form,"keywords",t)},expression:"form.keywords"}},e._l(e.keywords,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"关联类型"}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.typeChange},model:{value:e.form.relation,callback:function(t){e.$set(e.form,"relation",t)},expression:"form.relation"}},e._l(e.relation,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"关联内容"}},[1==e.form.relation?a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}},e._l(e.goodsList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})):2==e.form.relation?a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}},e._l(e.pageList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})):3==e.form.relation?a("el-upload",{attrs:{action:e.fileUrl,multiple:"",name:"files","file-list":e.content,"list-type":"picture-card",onError:e.uploadError,onSuccess:e.uploadDetailImageSuccess,beforeUpload:e.beforeAvatarUpload,"on-preview":e.handlePictureCardPreview,"on-remove":e.uploadDetailImageRemove}},[a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]):a("el-input",{model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"说明"}},[a("el-input",{model:{value:e.form.notes,callback:function(t){e.$set(e.form,"notes",t)},expression:"form.notes"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"排序编号"}},[a("el-input",{model:{value:e.form.sortNum,callback:function(t){e.$set(e.form,"sortNum",t)},expression:"form.sortNum"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.update("form")}}},[e._v("修改")]),e._v(" "),a("el-button",{on:{click:function(t){e.updateView=!1}}},[e._v("取消")])],1)],1)],1)],1)},staticRenderFns:[]};var u=a("vSla")(s,c,!1,function(e){a("DWv2")},null,null);t.default=u.exports}});